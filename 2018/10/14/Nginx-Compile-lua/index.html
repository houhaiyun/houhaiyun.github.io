<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Peter's technology stack."><title>Nginx编译lua | Keep learn!</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a><a class="sidebar-nav-item" href="/about">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Nginx/">Nginx</a></div><div class="post-time">2018-10-14</div></div></div><div class="container post-header"><h1>Nginx编译lua</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#编译第三方模块简介"><span class="toc-number">1.</span> <span class="toc-text">编译第三方模块简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ngx-devel-kit"><span class="toc-number">1.1.</span> <span class="toc-text">1. ngx_devel_kit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-lua-nginx-module"><span class="toc-number">1.2.</span> <span class="toc-text">2. lua-nginx-module</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编译参数及解释"><span class="toc-number">2.</span> <span class="toc-text">编译参数及解释</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#编译参数"><span class="toc-number">2.1.</span> <span class="toc-text">编译参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#参数解释"><span class="toc-number">2.2.</span> <span class="toc-text">参数解释</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#一键编译安装脚本"><span class="toc-number">3.</span> <span class="toc-text">一键编译安装脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#致谢"><span class="toc-number">4.</span> <span class="toc-text">致谢</span></a></li></ol></details></div><div class="container post-content"><h3 id="编译第三方模块简介"><a href="#编译第三方模块简介" class="headerlink" title="编译第三方模块简介"></a>编译第三方模块简介</h3><a id="more"></a>
<h4 id="1-ngx-devel-kit"><a href="#1-ngx-devel-kit" class="headerlink" title="1. ngx_devel_kit"></a>1. ngx_devel_kit</h4><p><a href="https://github.com/simpl/ngx_devel_kit/" target="_blank" rel="noopener">https://github.com/simpl/ngx_devel_kit/</a></p>
<p>ngx_devel_kit 模块是一个拓展 Nginx 服务器核心功能的模块，第三方模块开发可以基于它来快速实现。它提供函数和宏处理一些基本任务，减轻第三方模块开发的代码量。<br>开发者如果要依赖这个模块做开发，需要将这个模块一并参与编译，同时需要在自己的模块配置中声明所需要使用的特性。</p>
<h4 id="2-lua-nginx-module"><a href="#2-lua-nginx-module" class="headerlink" title="2. lua-nginx-module"></a>2. lua-nginx-module</h4><p><a href="https://github.com/openresty/lua-nginx-module/" target="_blank" rel="noopener">https://github.com/openresty/lua-nginx-module/</a></p>
<p>nginx_lua_module 是 Nginx 第三方模块,它能将 Lua 语言嵌入到nginx配置中，从而使用 Lua 就极大增强了 Nginx 的处理能力。</p>
<p>建议使用LuaJIT作为Lua解析器</p>
<h3 id="编译参数及解释"><a href="#编译参数及解释" class="headerlink" title="编译参数及解释"></a>编译参数及解释</h3><h4 id="编译参数"><a href="#编译参数" class="headerlink" title="编译参数"></a>编译参数</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">./configure </span><br><span class="line">--prefix=/usr/local/nginx </span><br><span class="line">--error-log-path=/var/log/nginx/error.log </span><br><span class="line">--http-log-path=/var/log/nginx/access.log </span><br><span class="line">--pid-path=/var/run/nginx.pid </span><br><span class="line">--lock-path=/var/run/nginx.lock </span><br><span class="line">--http-client-body-temp-path=/var/cache/nginx/client_temp </span><br><span class="line">--http-proxy-temp-path=/var/cache/nginx/proxy_temp </span><br><span class="line">--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp </span><br><span class="line">--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp </span><br><span class="line">--http-scgi-temp-path=/var/cache/nginx/scgi_temp </span><br><span class="line">--user=nginx </span><br><span class="line">--group=nginx </span><br><span class="line">--with-pcre </span><br><span class="line">--add-module=/usr/local/lua-nginx-module </span><br><span class="line">--add-module=/usr/local/ngx_devel_kit </span><br><span class="line">--with-http_ssl_module </span><br><span class="line">--with-http_realip_module </span><br><span class="line">--with-http_geoip_module </span><br><span class="line">--with-http_addition_module </span><br><span class="line">--with-http_sub_module </span><br><span class="line">--with-http_dav_module </span><br><span class="line">--with-http_flv_module </span><br><span class="line">--with-http_mp4_module </span><br><span class="line">--with-http_gunzip_module </span><br><span class="line">--with-http_gzip_static_module </span><br><span class="line">--with-http_random_index_module </span><br><span class="line">--with-http_secure_link_module </span><br><span class="line">--with-http_stub_status_module </span><br><span class="line">--with-http_auth_request_module </span><br><span class="line">--with-mail </span><br><span class="line">--with-mail_ssl_module </span><br><span class="line">--with-file-aio </span><br><span class="line">--with-ipv6 </span><br><span class="line">--with-http_v2_module</span><br></pre></td></tr></table></figure>
<h4 id="参数解释"><a href="#参数解释" class="headerlink" title="参数解释"></a>参数解释</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">--prefix=/usr/local/nginx \ # 指定安装目录</span><br><span class="line">--error-log-path=/var/log/nginx/error.log \ # 指定错误日志路径 </span><br><span class="line">--http-log-path=/var/log/nginx/access.log \ # 指定访问日志路径</span><br><span class="line">--pid-path=/var/run/nginx.pid 	\ # pid路径</span><br><span class="line">--lock-path=/var/run/nginx.lock 	\ # 锁文件路径</span><br><span class="line">--http-client-body-temp-path=/var/cache/nginx/client_temp 	\ # 定义用于存储包含客户端请求主体的临时文件的目录。</span><br><span class="line">--http-proxy-temp-path=/var/cache/nginx/proxy_temp 		\ # 定义用于存储临时文件的目录，其中包含从代理服务器接收的数据。</span><br><span class="line">--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp \ # 定义用于存储临时文件的目录，其中包含从FastCGI服务器接收的数据。</span><br><span class="line">--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp \ # 定义用于存储临时文件的目录，其中包含从uwsgi服务器接收的数据。</span><br><span class="line">--http-scgi-temp-path=/var/cache/nginx/scgi_temp \ #	定义用于存储包含从SCGI服务器接收的数据的临时文件的目录</span><br><span class="line">--user=nginx 	\ # 指明以那个身份运行worker进程，主控master进程一般由root运行</span><br><span class="line">--group=nginx  	\ # 组</span><br><span class="line">--with-pcre 	\ # PCRE(Perl Compatible Regular Expressions) 包括 perl 兼容的正规表达式库.这些在执行正规表达式模式匹配时用与Perl 5同样的语法和语义是很有用的.</span><br><span class="line">--add-module=/usr/local/lua-nginx-module 	\ # 添加lua-nginx-module模块</span><br><span class="line">--add-module=/usr/local/ngx_devel_kit 		\ # 添加ngx_devel_kit 模块</span><br><span class="line">--with-http_ssl_module 		\ # 支持ssl</span><br><span class="line">--with-http_realip_module 	\ # 用于将客户端地址和端口更改为PROXY协议头（1.11.4）中发送的端口和端口。定义已知可发送正确替换地址的可信地址</span><br><span class="line">--with-http_geoip_module 	\ # ngx_http_geoip_module 模块（0.8.6+）创建变量，使用预编译的MaxMind数据库解析客户端IP地址，得到变量值。</span><br><span class="line">--with-http_addition_module 	\ # ngx_http_addition_module模块是一个过滤器，可在响应之前和之后添加文本。</span><br><span class="line">--with-http_sub_module 	\ # ngx_http_sub_module模块是一个过滤器，它通过将一个指定的字符串替换为另一个来修改响应。</span><br><span class="line">--with-http_dav_module 	\ # ngx_http_dav_module模块旨在通过WebDAV协议实现文件管理自动化（WebDAV规范仅允许在现有目录中创建文件。该指令允许创建所有需要的中间目录。）</span><br><span class="line">--with-http_flv_module 	\ # ngx_http_flv_module模块为Flash Video（FLV）文件提供伪流服务器端支持</span><br><span class="line">--with-http_mp4_module 	\ # ngx_http_mp4_module模块为MP4文件提供伪流服务器端支持。这些文件通常具有.mp4，.m4v或.m4a文件扩展名。</span><br><span class="line">--with-http_gunzip_module 	\ # ngx_http_gunzip_module 模块将文件解压缩后并在响应头加上 &quot;Content-Encoding: gzip&quot; 返回给客户端。为了解决客户端不支持gzip压缩</span><br><span class="line">--with-http_gzip_static_module 	\ # ngx_http_gzip_static_module模块允许使用“ .gz”文件扩展名而不是常规文件发送预压缩文件。</span><br><span class="line">--with-http_random_index_module 	\ # ngx_http_random_index_module模块处理以斜杠字符（&apos; /&apos;）结尾的请求，并在目录中选择一个随机文件作为索引文件。</span><br><span class="line">--with-http_secure_link_module 	\ # 启用ngx_http_secure_link_module支持，计算和检查要求所需的安全链接网址。</span><br><span class="line">--with-http_stub_status_module  \ #  启用ngx_http_stub_status_module 支持查看nginx的状态页。</span><br><span class="line">--with-http_auth_request_module \ # 这个模块可以实现基于服务器内部子请求的返回结果来控制用户鉴权。比如子请求返回4xx则提示说没有权限，如果是2xx则会返回资源给客户端，返回401错误则把子请求的鉴权头透传给客户端。这样通过服务器内部逻辑就可以控制鉴权，省去不少业务逻辑层的脚本代码</span><br><span class="line">--with-mail 	\ # 启用POP3、IMAP4、SMTP代理模块</span><br><span class="line">--with-mail_ssl_module 	\ # 启用ngx_mail_ssl_module支持</span><br><span class="line">--with-file-aio 	\ # 异步非阻塞</span><br><span class="line">--with-ipv6 	\ # 启用iPv6支持</span><br><span class="line">--with-http_v2_module 	\ 支持http2.0协议</span><br></pre></td></tr></table></figure>
<h3 id="一键编译安装脚本"><a href="#一键编译安装脚本" class="headerlink" title="一键编译安装脚本"></a>一键编译安装脚本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> *****************************************************</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> File name: 	Install_Nginx.sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Revision: 	2.0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Date: 		2018-09-28 00:32:30</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Author: 		houhaiyun</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Email: 		houhaiyun18@163.com</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Website: 		https://www.ihaiyun.cc/</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Copyright: 	@2018 haiyun</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> License: 		LGPL v3</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Description:  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> *****************************************************</span></span><br><span class="line"></span><br><span class="line">null='/dev/null'</span><br><span class="line">Install_Dir='/usr/local/nginx'</span><br><span class="line">Nginx_Version='1.12.2'</span><br><span class="line"></span><br><span class="line">source /etc/init.d/functions</span><br><span class="line"></span><br><span class="line">CHK () &#123;</span><br><span class="line">    if [ $? -eq 0 ] ; then </span><br><span class="line">        action "$1"  /bin/true</span><br><span class="line">    else</span><br><span class="line">        action "$1" /bin/false</span><br><span class="line">        exit 1</span><br><span class="line">    fi  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Install_Befroe () &#123;</span><br><span class="line">    yum -y install  openssl-devel pcre-devel \</span><br><span class="line">        gcc make gcc-c++  autoconf automake   \</span><br><span class="line">        libxml2 libxslt     \</span><br><span class="line">        libxslt-devel \</span><br><span class="line">        gd-devel \</span><br><span class="line">        perl-devel perl-ExtUtils-Embed \</span><br><span class="line">        GeoIP GeoIP-devel GeoIP-data \</span><br><span class="line">        zlib-devel \</span><br><span class="line">        wget git \</span><br><span class="line">        lua-devel	&amp;&gt; $null</span><br><span class="line">    </span><br><span class="line">    CHK "Install compilation tool:"</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Download_Package () &#123;</span><br><span class="line">    wget http://nginx.org/download/nginx-$Nginx_Version\.tar.gz	&amp;&gt; $null</span><br><span class="line">    CHK "Download Nginx Packages:"</span><br><span class="line">    </span><br><span class="line">    tar xf nginx-$Nginx_Version\.tar.gz -C /usr/local/src  &amp;&gt; $null</span><br><span class="line">    mv nginx-$Nginx_Version\.tar.gz /tmp &amp;&gt; $null</span><br><span class="line">    CHK "Decompression package: "</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Download_lua_nginx_module () &#123;</span><br><span class="line">    wget https://github.com/openresty/lua-nginx-module/archive/v0.10.13.tar.gz &amp;&gt; $null</span><br><span class="line">    CHK "Download lua-nginx-module Packages:"</span><br><span class="line">    tar xf  v0.10.13.tar.gz -C /usr/local &amp;&gt; $null</span><br><span class="line">    CHK "Decompression package: "</span><br><span class="line">    mv /usr/local/lua-nginx-module-0.10.13 /usr/local/lua-nginx-module &amp;&gt; $null</span><br><span class="line">    CHK "Change name: "</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Download_ngx_devel_kit () &#123;</span><br><span class="line">    cd /usr/local</span><br><span class="line">    git clone https://github.com/simpl/ngx_devel_kit &amp;&gt; $null</span><br><span class="line">    CHK "Download ngx_devel_kit Packages: "    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Add_User () &#123;</span><br><span class="line">    useradd -r -s /sbin/nologin -m -d   /var/lib/nginx nginx &amp;&gt; $null</span><br><span class="line">    CHK "Add user nginx: "</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Create_dir () &#123;</span><br><span class="line">    mkdir -p /usr/local/nginx/&#123;sbin/nginx,modules,conf&#125;</span><br><span class="line">    chown -R nginx: /usr/local/nginx</span><br><span class="line">    mkdir -p /var/log/nginx</span><br><span class="line">    chown -R nginx: /var/log/nginx</span><br><span class="line">    mkdir -p /var/cache/nginx/&#123;client_temp,proxy_temp,fastcgi_temp,uwsgi_temp,scgi_temp&#125;</span><br><span class="line">    chown -R nginx: /var/cache/nginx</span><br><span class="line">    CHK "Create directory: "</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Install_Nginx () &#123;</span><br><span class="line">    cd /usr/local/src/nginx-1.12.2</span><br><span class="line">    ./configure  \</span><br><span class="line">    --prefix=$Install_Dir \</span><br><span class="line">    --error-log-path=/var/log/nginx/error.log  \</span><br><span class="line">    --http-log-path=/var/log/nginx/access.log  \</span><br><span class="line">    --pid-path=/var/run/nginx.pid  \</span><br><span class="line">    --lock-path=/var/run/nginx.lock  \</span><br><span class="line">    --http-client-body-temp-path=/var/cache/nginx/client_temp  \</span><br><span class="line">    --http-proxy-temp-path=/var/cache/nginx/proxy_temp  \</span><br><span class="line">    --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp  \</span><br><span class="line">    --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp  \</span><br><span class="line">    --http-scgi-temp-path=/var/cache/nginx/scgi_temp  \</span><br><span class="line">    --user=nginx  \</span><br><span class="line">    --group=nginx  \</span><br><span class="line">    --with-pcre  \</span><br><span class="line">    --add-module=/usr/local/lua-nginx-module  \</span><br><span class="line">    --add-module=/usr/local/ngx_devel_kit  \</span><br><span class="line">    --with-http_ssl_module  \</span><br><span class="line">    --with-http_realip_module  \</span><br><span class="line">    --with-http_geoip_module  \</span><br><span class="line">    --with-http_addition_module  \</span><br><span class="line">    --with-http_sub_module  \</span><br><span class="line">    --with-http_dav_module  \</span><br><span class="line">    --with-http_flv_module  \</span><br><span class="line">    --with-http_mp4_module  \</span><br><span class="line">    --with-http_gunzip_module  \</span><br><span class="line">    --with-http_gzip_static_module  \</span><br><span class="line">    --with-http_random_index_module  \</span><br><span class="line">    --with-http_secure_link_module  \</span><br><span class="line">    --with-http_stub_status_module  \</span><br><span class="line">    --with-http_auth_request_module  \</span><br><span class="line">    --with-mail  \</span><br><span class="line">    --with-mail_ssl_module  \</span><br><span class="line">    --with-file-aio  \</span><br><span class="line">    --with-http_v2_module    &amp;&gt; $null</span><br><span class="line">    CHK "Configure:"</span><br><span class="line">    make -j 4 &amp;&gt; $null  &amp;&amp; make install &amp;&gt; $null</span><br><span class="line">    CHK "Install Nginx: "</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo -e "\033[5;47;31mInstall Nginx-$Nginx_Version: \033[0m\n********************************************************************"</span><br><span class="line"></span><br><span class="line">Install_Befroe</span><br><span class="line">Download_Package</span><br><span class="line">Download_ngx_devel_kit</span><br><span class="line">Download_lua_nginx_module</span><br><span class="line">Add_User</span><br><span class="line">Create_dir</span><br><span class="line">Install_Nginx</span><br><span class="line"></span><br><span class="line">echo -e "\033[5;47;31mInstall Nginx-$Nginx_Version is OK!!!\033[0m\n********************************************************************"</span><br></pre></td></tr></table></figure>
<p>脚本函数解释：</p>
<ul>
<li>Install_Befroe：安装相关依赖包和编译工具包</li>
<li>Download_Package：下载Nginx软件包</li>
<li>Download_ngx_devel_kit：下载模块包ngx_devel_kit</li>
<li>Download_lua_nginx_module：下载模块包lua_nginx_module</li>
<li>Add_User：添加用户</li>
<li>Create_dir：创建目录</li>
<li>Install_Nginx：安装Nginx</li>
</ul>
<p>本脚本默认安装Nginx版本为1.12.2，可根据需求修改。</p>
<p>本脚本因时间原因写的匆忙，目前只是实现安装，还缺少很多判断，大家如有兴趣可自行更改！</p>
<h3 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h3><p><a href="http://nginx.org/en/docs/" target="_blank" rel="noopener">Nginx官方帮助文档：</a></p>
</div></div><div class="post-main post-comment"><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'keeplearn';
var disqus_identifier = '2018/10/14/Nginx-Compile-lua/';
var disqus_title = 'Nginx编译lua';
var disqus_url = 'https://keeplearn.vip/2018/10/14/Nginx-Compile-lua/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>