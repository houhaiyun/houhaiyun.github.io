<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Peter's technology stack."><title>安装Zabbix | Peter's technology stack.</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a><a class="sidebar-nav-item" href="/about">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/Zabbix/">Zabbix</a></div><div class="post-time">2017-11-23</div></div></div><div class="container post-header"><h1>安装Zabbix</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#环境"><span class="toc-number">1.</span> <span class="toc-text">环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#环境准备"><span class="toc-number">2.</span> <span class="toc-text">环境准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#修改主机名"><span class="toc-number">2.1.</span> <span class="toc-text">修改主机名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#同步时间"><span class="toc-number">2.2.</span> <span class="toc-text">同步时间</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下载并安装yum源"><span class="toc-number">3.</span> <span class="toc-text">下载并安装yum源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装MySQL"><span class="toc-number">4.</span> <span class="toc-text">安装MySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装zabbix"><span class="toc-number">5.</span> <span class="toc-text">安装zabbix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#为zabbix创建数据库"><span class="toc-number">6.</span> <span class="toc-text">为zabbix创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入zabbix的sql脚本"><span class="toc-number">7.</span> <span class="toc-text">导入zabbix的sql脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改zabbix-server配置文件"><span class="toc-number">8.</span> <span class="toc-text">修改zabbix-server配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改php配置文件"><span class="toc-number">9.</span> <span class="toc-text">修改php配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试访问"><span class="toc-number">10.</span> <span class="toc-text">测试访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#初始化设置"><span class="toc-number">11.</span> <span class="toc-text">初始化设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#登陆zabbix"><span class="toc-number">12.</span> <span class="toc-text">登陆zabbix</span></a></li></ol></details></div><div class="container post-content"><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><table>
<thead>
<tr>
<th>服务</th>
<th>IP</th>
<th>系统版本</th>
<th>软件版本</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>Zabbix-server</td>
<td>192.168.8.12/24</td>
<td>CentOS Linux release 7.3.1611 (Core)</td>
<td>zabbix-server-3.4.4</td>
<td>监控server</td>
</tr>
<tr>
<td>Nginx</td>
<td>192.168.8.15/24</td>
<td>CentOS Linux release 7.3.1611 (Core)</td>
<td>nginx-1.10.2</td>
<td>被监控server</td>
</tr>
</tbody>
</table>
<a id="more"></a>
<h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><h4 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Zabbix-server配置</span><br><span class="line">[root@centos7 ~]# hostnamectl set-hostname Zabbix-server.haiyun.com</span><br><span class="line">[root@centos7 ~]# exec bash</span><br><span class="line"></span><br><span class="line"># Zabbix-client1配置</span><br><span class="line">[root@centos7 ~]# hostnamectl set-hostname Zabbix-client1.haiyun.com &amp;&amp; exec bash</span><br><span class="line">[root@zabbix-client1 ~]# </span><br><span class="line"></span><br><span class="line"># Zabbix-client2配置</span><br><span class="line">[root@centos7 ~]# hostnamectl set-hostname Zabbix-client2.haiyun.com &amp;&amp; exec bash</span><br><span class="line">[root@zabbix-client2 ~]#</span><br></pre></td></tr></table></figure>
<h4 id="同步时间"><a href="#同步时间" class="headerlink" title="同步时间"></a>同步时间</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># Zabbix-server配置</span><br><span class="line">[root@zabbix-server ~]# ntpdate 172.18.0.1</span><br><span class="line">21 Nov 17:58:10 ntpdate[2160]: step time server 172.18.0.1 offset -2.293672 sec</span><br><span class="line">[root@zabbix-server ~]# date</span><br><span class="line">Tue Nov 21 17:58:14 CST 2017</span><br><span class="line">[root@zabbix-server ~]#</span><br><span class="line"></span><br><span class="line"># Zabbix-client1配置</span><br><span class="line">[root@zabbix-client1 ~]# ntpdate 172.18.0.1</span><br><span class="line">21 Nov 17:58:10 ntpdate[2177]: step time server 172.18.0.1 offset -2.263705 sec</span><br><span class="line">[root@zabbix-client1 ~]# date</span><br><span class="line">Tue Nov 21 17:58:14 CST 2017</span><br><span class="line"></span><br><span class="line"># Zabbix-client2配置</span><br><span class="line">[root@zabbix-client2 ~]# ntpdate 172.18.0.1</span><br><span class="line">21 Nov 17:58:10 ntpdate[2127]: step time server 172.18.0.1 offset -1.696126 sec</span><br><span class="line">[root@zabbix-client2 ~]# date</span><br><span class="line">Tue Nov 21 17:58:14 CST 2017</span><br></pre></td></tr></table></figure>
<h3 id="下载并安装yum源"><a href="#下载并安装yum源" class="headerlink" title="下载并安装yum源"></a>下载并安装yum源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server ~]# wget http://repo.zabbix.com/zabbix/3.4/rhel/7/x86_64/zabbix-release-3.4-2.el7.noarch.rpm         # 从官网下载yum源包</span><br><span class="line">--2017-11-21 19:34:01--  http://repo.zabbix.com/zabbix/3.4/rhel/7/x86_64/zabbix-release-3.4-2.el7.noarch.rpm</span><br><span class="line">Resolving repo.zabbix.com (repo.zabbix.com)... 162.243.159.138</span><br><span class="line">Connecting to repo.zabbix.com (repo.zabbix.com)|162.243.159.138|:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 13572 (13K) [application/x-redhat-package-manager]</span><br><span class="line">Saving to: ‘zabbix-release-3.4-2.el7.noarch.rpm’</span><br><span class="line"></span><br><span class="line">100%[===========================================&gt;] 13,572      --.-K/s   in 0s      </span><br><span class="line"></span><br><span class="line">2017-11-21 19:34:01 (155 MB/s) - ‘zabbix-release-3.4-2.el7.noarch.rpm’ saved [13572/13572]</span><br><span class="line">[root@zabbix-server ~]# rpm -ivh zabbix-release-3.4-2.el7.noarch.rpm </span><br><span class="line">warning: zabbix-release-3.4-2.el7.noarch.rpm: Header V4 RSA/SHA512 Signature, key ID a14fe591: NOKEY</span><br><span class="line">Preparing...                          ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:zabbix-release-3.4-2.el7         ################################# [100%]</span><br><span class="line">[root@zabbix-server ~]# rpm -ql zabbix-release</span><br><span class="line">/etc/pki/rpm-gpg/RPM-GPG-KEY-ZABBIX</span><br><span class="line">/etc/pki/rpm-gpg/RPM-GPG-KEY-ZABBIX-A14FE591</span><br><span class="line">/etc/yum.repos.d/zabbix.repo</span><br><span class="line">/usr/share/doc/zabbix-release-3.4</span><br><span class="line">/usr/share/doc/zabbix-release-3.4/GPL</span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]# yum repolist</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">file://misc/cd/repodata/repomd.xml: [Errno 14] curl#37 - &quot;Couldn&apos;t open file /cd/repodata/repomd.xml&quot;</span><br><span class="line">Trying other mirror.</span><br><span class="line">epel                                                          | 4.3 kB  00:00:00     </span><br><span class="line">zabbix                                                        | 2.9 kB  00:00:00     </span><br><span class="line">zabbix-non-supported                                          |  951 B  00:00:00     </span><br><span class="line">zabbix/x86_64/primary_db                                      |  44 kB  00:00:00     </span><br><span class="line">zabbix-non-supported/x86_64/primary                           | 1.6 kB  00:00:00     </span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">zabbix-non-supported                                                             4/4</span><br><span class="line">repo id                     repo name                                          status</span><br><span class="line">!base                       base                                                9,363</span><br><span class="line">epel                        epel                                               11,349</span><br><span class="line">zabbix/x86_64               Zabbix Official Repository - x86_64                    80</span><br><span class="line">zabbix-non-supported/x86_64 Zabbix Official Repository non-supported - x86_64       4</span><br><span class="line">repolist: 20,796</span><br></pre></td></tr></table></figure>
<h3 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server ~]# yum install mariadb-server      # 安装mariadb</span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]# vim /etc/my.cnf.d/server.cnf        # 修改配置文件</span><br><span class="line">[server]</span><br><span class="line">skip_name_resolve = ON</span><br><span class="line">innodb_file_per_table = ON</span><br><span class="line">innodb_buffer_pool_size = 256M</span><br><span class="line">max_connections = 2000</span><br><span class="line"></span><br><span class="line">log-bin = master-log</span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]# systemctl start mariadb.service     # 启动mariadb</span><br><span class="line">[root@zabbix-server ~]# mysql_secure_installation       # 执行安全优化脚本</span><br><span class="line"></span><br><span class="line">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span><br><span class="line">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class="line"></span><br><span class="line">In order to log into MariaDB to secure it, we&apos;ll need the current</span><br><span class="line">password for the root user.  If you&apos;ve just installed MariaDB, and</span><br><span class="line">you haven&apos;t set the root password yet, the password will be blank,</span><br><span class="line">so you should just press enter here.</span><br><span class="line"></span><br><span class="line">Enter current password for root (enter for none): </span><br><span class="line">OK, successfully used password, moving on...</span><br><span class="line"></span><br><span class="line">Setting the root password ensures that nobody can log into the MariaDB</span><br><span class="line">root user without the proper authorisation.</span><br><span class="line"></span><br><span class="line">Set root password? [Y/n] y</span><br><span class="line">New password: </span><br><span class="line">Re-enter new password: </span><br><span class="line">Password updated successfully!</span><br><span class="line">Reloading privilege tables..</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">By default, a MariaDB installation has an anonymous user, allowing anyone</span><br><span class="line">to log into MariaDB without having to have a user account created for</span><br><span class="line">them.  This is intended only for testing, and to make the installation</span><br><span class="line">go a bit smoother.  You should remove them before moving into a</span><br><span class="line">production environment.</span><br><span class="line"></span><br><span class="line">Remove anonymous users? [Y/n] n</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">Normally, root should only be allowed to connect from &apos;localhost&apos;.  This</span><br><span class="line">ensures that someone cannot guess at the root password from the network.</span><br><span class="line"></span><br><span class="line">Disallow root login remotely? [Y/n] n</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">By default, MariaDB comes with a database named &apos;test&apos; that anyone can</span><br><span class="line">access.  This is also intended only for testing, and should be removed</span><br><span class="line">before moving into a production environment.</span><br><span class="line"></span><br><span class="line">Remove test database and access to it? [Y/n] n</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">Reloading the privilege tables will ensure that all changes made so far</span><br><span class="line">will take effect immediately.</span><br><span class="line"></span><br><span class="line">Reload privilege tables now? [Y/n] y</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line">Cleaning up...</span><br><span class="line"></span><br><span class="line">All done!  If you&apos;ve completed all of the above steps, your MariaDB</span><br><span class="line">installation should now be secure.</span><br><span class="line"></span><br><span class="line">Thanks for using MariaDB!</span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]# mysql -phaiyun      </span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 6</span><br><span class="line">Server version: 5.5.52-MariaDB MariaDB Server       # 连接成功；</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; \q</span><br><span class="line">Bye</span><br></pre></td></tr></table></figure>
<h3 id="安装zabbix"><a href="#安装zabbix" class="headerlink" title="安装zabbix"></a>安装zabbix</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server ~]# yum install zabbix-server zabbix-web-mysql zabbix-agent zabbix-get zabbix-sender zabbix-web</span><br></pre></td></tr></table></figure>
<h3 id="为zabbix创建数据库"><a href="#为zabbix创建数据库" class="headerlink" title="为zabbix创建数据库"></a>为zabbix创建数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server ~]# mysql -phaiyun</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 7</span><br><span class="line">Server version: 5.5.52-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; CREATE DATABASE zbxdb CHARACTER SET &quot;utf8&quot;;       # 为Zabbix创建数据库，注意：创建数据库需要指定字符集为utf8，如果不指定，显示中文界面的zabbix时可能会出问题</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; GRANT ALL ON zbxdb.* TO &apos;zbxuser&apos;@&apos;192.168.8.12&apos; IDENTIFIED BY &apos;zbxpass&apos;;     # 授权用户；</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="导入zabbix的sql脚本"><a href="#导入zabbix的sql脚本" class="headerlink" title="导入zabbix的sql脚本"></a>导入zabbix的sql脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server ~]# rpm -ql zabbix-server-mysql         </span><br><span class="line">/etc/logrotate.d/zabbix-server</span><br><span class="line">/etc/zabbix/zabbix_server.conf</span><br><span class="line">/usr/lib/systemd/system/zabbix-server.service</span><br><span class="line">/usr/lib/tmpfiles.d/zabbix-server.conf</span><br><span class="line">/usr/lib/zabbix/alertscripts</span><br><span class="line">/usr/lib/zabbix/externalscripts</span><br><span class="line">/usr/sbin/zabbix_server_mysql</span><br><span class="line">/usr/share/doc/zabbix-server-mysql-3.4.4</span><br><span class="line">/usr/share/doc/zabbix-server-mysql-3.4.4/AUTHORS</span><br><span class="line">/usr/share/doc/zabbix-server-mysql-3.4.4/COPYING</span><br><span class="line">/usr/share/doc/zabbix-server-mysql-3.4.4/ChangeLog</span><br><span class="line">/usr/share/doc/zabbix-server-mysql-3.4.4/NEWS</span><br><span class="line">/usr/share/doc/zabbix-server-mysql-3.4.4/README</span><br><span class="line">/usr/share/doc/zabbix-server-mysql-3.4.4/create.sql.gz</span><br><span class="line">/usr/share/man/man8/zabbix_server.8.gz</span><br><span class="line">/var/log/zabbix</span><br><span class="line">/var/run/zabbix</span><br><span class="line">[root@zabbix-server ~]# cp /usr/share/doc/zabbix-server-mysql-3.4.4/create.sql.gz ./</span><br><span class="line">[root@zabbix-server ~]# ls</span><br><span class="line">create.sql.gz</span><br><span class="line">[root@zabbix-server ~]# gzip -d create.sql.gz </span><br><span class="line">[root@zabbix-server ~]# ls</span><br><span class="line">create.sql</span><br><span class="line">[root@zabbix-server ~]# head -20 create.sql </span><br><span class="line">CREATE TABLE `users` (</span><br><span class="line">	`userid`                 bigint unsigned                           NOT NULL,</span><br><span class="line">	`alias`                  varchar(100)    DEFAULT &apos;&apos;                NOT NULL,</span><br><span class="line">	`name`                   varchar(100)    DEFAULT &apos;&apos;                NOT NULL,</span><br><span class="line">	`surname`                varchar(100)    DEFAULT &apos;&apos;                NOT NULL,</span><br><span class="line">	`passwd`                 char(32)        DEFAULT &apos;&apos;                NOT NULL,</span><br><span class="line">	`url`                    varchar(255)    DEFAULT &apos;&apos;                NOT NULL,</span><br><span class="line">	`autologin`              integer         DEFAULT &apos;0&apos;               NOT NULL,</span><br><span class="line">	`autologout`             varchar(32)     DEFAULT &apos;15m&apos;             NOT NULL,</span><br><span class="line">	`lang`                   varchar(5)      DEFAULT &apos;en_GB&apos;           NOT NULL,</span><br><span class="line">	`refresh`                varchar(32)     DEFAULT &apos;30s&apos;             NOT NULL,</span><br><span class="line">	`type`                   integer         DEFAULT &apos;1&apos;               NOT NULL,</span><br><span class="line">	`theme`                  varchar(128)    DEFAULT &apos;default&apos;         NOT NULL,</span><br><span class="line">	`attempt_failed`         integer         DEFAULT 0                 NOT NULL,</span><br><span class="line">	`attempt_ip`             varchar(39)     DEFAULT &apos;&apos;                NOT NULL,</span><br><span class="line">	`attempt_clock`          integer         DEFAULT 0                 NOT NULL,</span><br><span class="line">	`rows_per_page`          integer         DEFAULT 50                NOT NULL,</span><br><span class="line">	PRIMARY KEY (userid)</span><br><span class="line">) ENGINE=InnoDB;</span><br><span class="line">CREATE UNIQUE INDEX `users_1` ON `users` (`alias`);</span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]# mysql -uzbxuser -pzbxpass -h192.168.8.12 zbxdb &lt; create.sql     # 导入zabbix提供创建表的sql脚本；</span><br><span class="line"></span><br><span class="line">[root@zabbix-server ~]# mysql -uzbxuser -pzbxpass -h192.168.8.12 </span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 20</span><br><span class="line">Server version: 5.5.52-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; USE zbxdb</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [zbxdb]&gt; SHOW TABLES;       # 表已经创建成功；</span><br><span class="line">+----------------------------+</span><br><span class="line">| Tables_in_zbxdb            |</span><br><span class="line">+----------------------------+</span><br><span class="line">| acknowledges               |</span><br><span class="line">| actions                    |</span><br><span class="line">| alerts                     |</span><br><span class="line">| 。。。省略部分内容         |</span><br><span class="line">| timeperiods                |</span><br><span class="line">| trends                     |</span><br><span class="line">| trends_uint                |</span><br><span class="line">| trigger_depends            |</span><br><span class="line">| trigger_discovery          |</span><br><span class="line">| trigger_tag                |</span><br><span class="line">| triggers                   |</span><br><span class="line">| users                      |</span><br><span class="line">| users_groups               |</span><br><span class="line">| usrgrp                     |</span><br><span class="line">| valuemaps                  |</span><br><span class="line">| widget                     |</span><br><span class="line">| widget_field               |</span><br><span class="line">+----------------------------+</span><br><span class="line">140 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="修改zabbix-server配置文件"><a href="#修改zabbix-server配置文件" class="headerlink" title="修改zabbix-server配置文件"></a>修改zabbix-server配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server zabbix]# grep -i &quot;^[^#]&quot; zabbix_server.conf     # 过滤已经修改的配置；</span><br><span class="line">ListenPort=10051</span><br><span class="line">SourceIP=192.168.8.12</span><br><span class="line">LogFile=/var/log/zabbix/zabbix_server.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">DebugLevel=3</span><br><span class="line">PidFile=/var/run/zabbix/zabbix_server.pid</span><br><span class="line">SocketDir=/var/run/zabbix</span><br><span class="line">DBHost=192.168.8.12</span><br><span class="line">DBName=zbxdb</span><br><span class="line">DBUser=zbxuser</span><br><span class="line">DBPassword=zbxpass</span><br><span class="line">DBPort=3306</span><br><span class="line">SNMPTrapperFile=/var/log/snmptrap/snmptrap.log</span><br><span class="line">Timeout=4</span><br><span class="line">AlertScriptsPath=/usr/lib/zabbix/alertscripts</span><br><span class="line">ExternalScripts=/usr/lib/zabbix/externalscripts</span><br><span class="line">LogSlowQueries=3000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@zabbix-server zabbix]# systemctl start zabbix-server.service          # 启动zabbix-server服务</span><br></pre></td></tr></table></figure>
<h3 id="修改php配置文件"><a href="#修改php配置文件" class="headerlink" title="修改php配置文件"></a>修改php配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@zabbix-server conf.d]# vim /etc/php.ini       # 修改php时区，此项必须设置；</span><br><span class="line">date.timezone = Asia/Shanghai</span><br><span class="line">[root@zabbix-server ~]# systemctl start httpd       # 启动httpd；</span><br></pre></td></tr></table></figure>
<h3 id="测试访问"><a href="#测试访问" class="headerlink" title="测试访问"></a>测试访问</h3><center><img src="https://houhaiyun.github.io/img/images/Zabbix-Install-1.gif" title="测试访问"></center>


<h3 id="初始化设置"><a href="#初始化设置" class="headerlink" title="初始化设置"></a>初始化设置</h3><center><img src="https://houhaiyun.github.io/img/images/Zabbix-Install-2.gif" title="初始化设置"></center>

<h3 id="登陆zabbix"><a href="#登陆zabbix" class="headerlink" title="登陆zabbix"></a>登陆zabbix</h3><p>默认登陆用户名为<code>admin</code>，密码为<code>zabbix</code></p>
<center><img src="https://houhaiyun.github.io/img/images/Zabbix-Install-3.gif" title="登陆zabbix"></center>
</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>