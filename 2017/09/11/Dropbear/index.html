<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Peter's technology stack."><title>Dropbear-轻量级SSH服务器和客户端 | Keep learn!</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a><a class="sidebar-nav-item" href="/about">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/ssh/">ssh</a></div><div class="post-time">2017-09-11</div></div></div><div class="container post-header"><h1>Dropbear-轻量级SSH服务器和客户端</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dropbear简介"><span class="toc-number">1.</span> <span class="toc-text">Dropbear简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装drobear"><span class="toc-number">2.</span> <span class="toc-text">安装drobear</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、安装依赖包"><span class="toc-number">2.1.</span> <span class="toc-text">1、安装依赖包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、下载dropbear"><span class="toc-number">2.2.</span> <span class="toc-text">2、下载dropbear</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、安装Drobear"><span class="toc-number">2.3.</span> <span class="toc-text">3、安装Drobear</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dropbear的使用"><span class="toc-number">3.</span> <span class="toc-text">Dropbear的使用</span></a></li></ol></details></div><div class="container post-content"><h3 id="Dropbear简介"><a href="#Dropbear简介" class="headerlink" title="Dropbear简介"></a>Dropbear简介</h3><p><code>Dropbear</code>是一个相对较小的SSH服务器和客户端。它运行在各种基于<code>POSIX</code>的平台上。<code>Dropbear</code>是一种开源软件，以<code>MIT</code>风格的许可证分发。<code>Dropbear</code>对于“嵌入”型<code>Linux</code>（或其他<code>Unix</code>）系统（如无线路由器）特别有用。——<code>Dropbear</code>官网</p>
<p><a href="https://matt.ucc.asn.au/dropbear/dropbear.html" target="_blank" rel="noopener">官网：https://matt.ucc.asn.au/dropbear/dropbear.html</a></p>
<a id="more"></a>
<h3 id="安装drobear"><a href="#安装drobear" class="headerlink" title="安装drobear"></a>安装drobear</h3><h4 id="1、安装依赖包"><a href="#1、安装依赖包" class="headerlink" title="1、安装依赖包"></a>1、安装依赖包</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@A dropbear-2017.75]# yum groupinstall -y "Development tools"		#安装开发包组</span><br><span class="line">[root@A dropbear-2017.75]# yum install -y zlib-devel zlib		#安装zlib数据压缩库</span><br></pre></td></tr></table></figure>
<h4 id="2、下载dropbear"><a href="#2、下载dropbear" class="headerlink" title="2、下载dropbear"></a>2、下载dropbear</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@A ~]# wget https://matt.ucc.asn.au/dropbear/dropbear-2017.75.tar.bz2	#通过wget下载</span><br><span class="line">--2017-09-13 11:58:07--  https://matt.ucc.asn.au/dropbear/dropbear-2017.75.tar.bz2</span><br><span class="line">Resolving matt.ucc.asn.au... 130.95.13.18, 2405:3c00:5200<img class="github-emoji" title="100" alt="100" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4af.png?v8" height="20" width="20">:18</span><br><span class="line">Connecting to matt.ucc.asn.au|130.95.13.18|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 1623392 (1.5M) [application/x-bzip2]</span><br><span class="line">Saving to: “dropbear-2017.75.tar.bz2”</span><br><span class="line"></span><br><span class="line"><span class="meta">100%</span>[=======================================&gt;] 1,623,392    441K/s   in 3.6s    </span><br><span class="line"></span><br><span class="line">2017-09-13 11:58:13 (441 KB/s) - “dropbear-2017.75.tar.bz2” saved [1623392/1623392]</span><br></pre></td></tr></table></figure>
<h4 id="3、安装Drobear"><a href="#3、安装Drobear" class="headerlink" title="3、安装Drobear"></a>3、安装Drobear</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@A app]# tar xf dropbear-2017.75.tar.bz2 		#解压</span><br><span class="line">[root@A app]# ls								#查看解压后的目录</span><br><span class="line">dropbear-2017.75  dropbear-2017.75.tar.bz2</span><br><span class="line">[root@A app]# cd dropbear-2017.75/				#切换到解压后的目录中</span><br><span class="line">[root@A dropbear-2017.75]# ./configure			#开始检查环境，并生成makefile文件</span><br><span class="line">。。。省略部分内容</span><br><span class="line">configure: creating ./config.status</span><br><span class="line">config.status: creating Makefile</span><br><span class="line">config.status: creating libtomcrypt/Makefile</span><br><span class="line">config.status: creating libtommath/Makefile</span><br><span class="line">config.status: creating config.h</span><br><span class="line">configure: </span><br><span class="line">configure: Using bundled libtomcrypt and libtommath</span><br><span class="line">configure: </span><br><span class="line">configure: Now edit options.h to choose features.</span><br><span class="line">[root@A dropbear-2017.75]# make					#根据Makefile文件，构建应用程序dropbear</span><br><span class="line">[root@A dropbear-2017.75]# make install 		#开始安装，复制文件到相应路径</span><br><span class="line">install -d /usr/local/sbin</span><br><span class="line">install dropbear /usr/local/sbin</span><br><span class="line">install -d /usr/local/share/man/man8</span><br><span class="line">install -m 644 ./dropbear.8 /usr/local/share/man/man8/dropbear.8</span><br><span class="line">install -d /usr/local/bin</span><br><span class="line">install dbclient /usr/local/bin</span><br><span class="line">install -d /usr/local/share/man/man1</span><br><span class="line">if test -e dbclient.1; then install -m 644 dbclient.1 /usr/local/share/man/man1/dbclient.1; fi</span><br><span class="line">install -d /usr/local/bin</span><br><span class="line">install dropbearkey /usr/local/bin</span><br><span class="line">install -d /usr/local/share/man/man1</span><br><span class="line">if test -e dropbearkey.1; then install -m 644 dropbearkey.1 /usr/local/share/man/man1/dropbearkey.1; fi</span><br><span class="line">install -d /usr/local/bin</span><br><span class="line">install dropbearconvert /usr/local/bin</span><br><span class="line">install -d /usr/local/share/man/man1</span><br><span class="line">if test -e dropbearconvert.1; then install -m 644 dropbearconvert.1 /usr/local/share/man/man1/dropbearconvert.1; fi</span><br></pre></td></tr></table></figure>
<h3 id="Dropbear的使用"><a href="#Dropbear的使用" class="headerlink" title="Dropbear的使用"></a>Dropbear的使用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">[root@A dropbear-2017.75]# ls /usr/local/sbin/ /usr/local/bin/		#查看是否在对应的目录下生成文件</span><br><span class="line">/usr/local/bin/:</span><br><span class="line">dbclient  dropbearconvert  dropbearkey</span><br><span class="line"></span><br><span class="line">/usr/local/sbin/:</span><br><span class="line">dropbear</span><br><span class="line">[root@A dropbear-2017.75]# /usr/local/sbin/dropbear -h 			#查看帮助信息</span><br><span class="line">Dropbear server v2017.75 https://matt.ucc.asn.au/dropbear/dropbear.html</span><br><span class="line">Usage: /usr/local/sbin/dropbear [options]</span><br><span class="line">-b bannerfile	Display the contents of bannerfile before user login</span><br><span class="line">		(default: none)</span><br><span class="line">-r keyfile  Specify hostkeys (repeatable)</span><br><span class="line">		defaults: </span><br><span class="line">		dss /etc/dropbear/dropbear_dss_host_key</span><br><span class="line">		rsa /etc/dropbear/dropbear_rsa_host_key</span><br><span class="line">		ecdsa /etc/dropbear/dropbear_ecdsa_host_key</span><br><span class="line">-R		Create hostkeys as required</span><br><span class="line">-F		Don't fork into background</span><br><span class="line">-E		Log to stderr rather than syslog</span><br><span class="line">-m		Don't display the motd on login</span><br><span class="line">-w		Disallow root logins</span><br><span class="line">-s		Disable password logins</span><br><span class="line">-g		Disable password logins for root</span><br><span class="line">-B		Allow blank password logins</span><br><span class="line">-j		Disable local port forwarding</span><br><span class="line">-k		Disable remote port forwarding</span><br><span class="line">-a		Allow connections to forwarded ports from any host</span><br><span class="line">-p [address:]port</span><br><span class="line">		Listen on specified tcp port (and optionally address),</span><br><span class="line">		up to 10 can be specified</span><br><span class="line">		(default port is 22 if none specified)</span><br><span class="line">-P PidFile	Create pid file PidFile</span><br><span class="line">		(default /var/run/dropbear.pid)</span><br><span class="line">-i		Start for inetd</span><br><span class="line">-W &lt;receive_window_buffer&gt; (default 24576, larger may be faster, max 1MB)</span><br><span class="line">-K &lt;keepalive&gt;  (0 is never, default 0, in seconds)</span><br><span class="line">-I &lt;idle_timeout&gt;  (0 is never, default 0, in seconds)</span><br><span class="line">-V    Version</span><br><span class="line">[root@A ~]# mkdir /etc/dropbear				#创建存放密钥目录</span><br><span class="line">[root@A ~]# dropbearkey -t rsa -f /etc/dropbear/dropbear_rsa_host_key -s 2048	#使用rsa算法生成2048位的密钥</span><br><span class="line">Generating key, this may take a while...</span><br><span class="line">Public key portion is:</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC7Pq2ndItUzwY/iHEs/xhIscet510HnQq0lE1yz43B5dXNCv+jDNOdMf3j2XySxtr0J82r2b/+qIp2tRBBmlO7URI8VQA+1J7nM9CP6oJ3ucLSAyVsbc/aIba9JFeKxZLcFdoLT4+M657ef7NcSE2IDvzPBriNXKQxR8Erda5xIcnPDSvNawSn809iJVhjq+gAWVxwHuLNpZst2xb9A6Q+8FCM44UZUpSnIh0u5LNstCGsMc9ClQDSeyNhhBcftBG1oYf2eTEVhpNF5Pu26MA/mXAbTbhgaB/2yaF93Xx6vFO2mAy/6o5xcRJrEdXkD9X3ZQr7xKDdwPtKEJKh4d15 root@A</span><br><span class="line">Fingerprint: md5 76:65:cb:ee:4e:a5:41:bd:2e:81:3a:5e:3b:b6:14:99</span><br><span class="line">[root@A ~]# dropbearkey -t dss -f /etc/dropbear/dropbear_dsa_host_key	#使用dss算法生成密钥</span><br><span class="line">Generating key, this may take a while...</span><br><span class="line">Public key portion is:</span><br><span class="line">ssh-dss AAAAB3NzaC1kc3MAAACBAOVp1GiSHc0Jgr/zTODQUlt7jF+jOyv0abzQKY7V6hY5UZAQhz0I0vxWCMHzcY+SVY7svSQCC9iWsoJ2ZO6rPkZLF3adOuG7EFFD6AvNtKF5w5W6cAzOzlqycf7U9JHuszZbVawtthX5w1p5f8eq8kP6sPwCrFzV883Na76MxfVBAAAAFQCT5pQj9ZYapyfPszAv3DyKsAwO6QAAAIEApZzegodTTfU/aX8Tlca2SBZ7Rlj3MF8zeQBjktFZHWeUoEhpRk41bsScuydgs8uW6HX+U8Nk9gx1AHur1rUi/qAZvRUGnUJndm/4Mljc4tmDobu8bKzR0HFtUHidlHailLOFpQTOAxOGcvY2Uv0mkuouG48nloS63bEDUtGPxUMAAACBAL76pIb4YBsT+eGvsvIgNXDZHKnz8QUZYR/+XBV6OelCt26rvbiwot7kTlvbwADJBMIIP0YVar2K8Z5CyYza5A2h6rvs4rgrKSmb/EHb1v1q/Nqjmk33BqWkNf6D3o649yjJd3Lk2/N1hLuhYrvZhq7NUoo2oH5H0RNTTkEYDfYC root@A</span><br><span class="line">Fingerprint: md5 ff:5d:02:f5:7f:8b:9d:ad:64:d1:ca:7c:16:b5:1c:1b</span><br><span class="line">[root@A ~]# dropbear -p :2222 -F -E			#在前台启动dropbear端口位2222</span><br><span class="line">[7250] Sep 13 13:42:07 Failed loading /etc/dropbear/dropbear_dss_host_key</span><br><span class="line">[7250] Sep 13 13:42:07 Failed loading /etc/dropbear/dropbear_ecdsa_host_key</span><br><span class="line">[7250] Sep 13 13:42:07 Not backgrounding</span><br><span class="line"></span><br><span class="line">[7281] Sep 13 13:42:52 Child connection from 192.168.8.129:49634</span><br><span class="line">[7281] Sep 13 13:42:56 Password auth succeeded for 'root' from 192.168.8.129:49634</span><br><span class="line">[root@B ~]# ssh 192.168.8.128 -p 2222		#使用B去连A可以链接</span><br><span class="line">The authenticity of host '[192.168.8.128]:2222 ([192.168.8.128]:2222)' can't be established.</span><br><span class="line">RSA key fingerprint is 76:65:cb:ee:4e:a5:41:bd:2e:81:3a:5e:3b:b6:14:99.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added '[192.168.8.128]:2222' (RSA) to the list of known hosts.</span><br><span class="line">root@192.168.8.128's password: </span><br><span class="line">[root@A ~]# dbclient 192.168.8.129			#使用dropbear的客户端工具连接B，可以连接</span><br><span class="line"></span><br><span class="line">Host '192.168.8.129' is not in the trusted hosts file.</span><br><span class="line">(ecdsa-sha2-nistp256 fingerprint md5 22:11:3a:21:03:37:06:e4:8c:45:65:ae:6e:a4:37:9a)</span><br><span class="line">Do you want to continue connecting? (y/n) y</span><br><span class="line">root@192.168.8.129's password: </span><br><span class="line">Last login: Wed Sep 13 14:09:45 2017 from 192.168.8.1</span><br><span class="line">[root@A ~]# dropbear -p :2345 			#在后台启动dropbear端口为2345</span><br><span class="line">[root@A ~]# netstat -anp| grep 2345		#2345端口已经启动</span><br><span class="line">tcp        0      0 0.0.0.0:2345                0.0.0.0:*                   LISTEN      7315/dropbear       </span><br><span class="line">tcp        0      0 :::2345                     :::*                        LISTEN      7315/dropbear   	</span><br><span class="line">[root@B ~]# ssh 192.168.8.128 -p 2345		#在B上去连A的2345端口可以连接</span><br><span class="line">The authenticity of host '[192.168.8.128]:2345 ([192.168.8.128]:2345)' can't be established.</span><br><span class="line">RSA key fingerprint is 76:65:cb:ee:4e:a5:41:bd:2e:81:3a:5e:3b:b6:14:99.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added '[192.168.8.128]:2345' (RSA) to the list of known hosts.</span><br><span class="line">root@192.168.8.128's password:</span><br></pre></td></tr></table></figure>
</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>